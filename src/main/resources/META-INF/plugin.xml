<idea-plugin>
    <id>io.qent.sona</id>
    <name>Sona</name>
    <vendor>qent</vendor>

    <dependencies>
        <module name="intellij.libraries.skiko"></module>
        <module name="intellij.libraries.compose.foundation.desktop"></module>
        <module name="intellij.platform.jewel.foundation"></module>
        <module name="intellij.platform.jewel.ui"></module>
        <module name="intellij.platform.jewel.ideLafBridge"></module>
    </dependencies>

    <depends optional="true" config-file="kotlin.xml">org.jetbrains.kotlin</depends>

    <resource-bundle>messages.Strings</resource-bundle>

    <actions>
        <action id="CreateNewChatAction"
                class="io.qent.sona.actions.CreateNewChatAction"
                textKey="createAction"
                descriptionKey="createActionDescription"
                icon="AllIcons.General.Add"/>

        <action id="OpenHistoryAction"
                class="io.qent.sona.actions.OpenHistoryAction"
                textKey="historyAction"
                descriptionKey="historyActionDescription"
                icon="AllIcons.General.History"/>

        <action id="OpenRolesAction"
                class="io.qent.sona.actions.OpenRolesAction"
                textKey="rolesAction"
                descriptionKey="rolesActionDescription"
                icon="AllIcons.General.User"/>

        <action id="OpenUserPromptAction"
                class="io.qent.sona.actions.OpenUserPromptAction"
                textKey="userSystemPromptAction"
                descriptionKey="userSystemPromptActionDescription"
                icon="AllIcons.FileTypes.Text"/>

        <action id="OpenPresetsAction"
                class="io.qent.sona.actions.OpenPresetsAction"
                textKey="presetsAction"
                descriptionKey="presetsActionDescription"
                icon="AllIcons.General.GearPlain"/>

        <action id="OpenServersAction"
                class="io.qent.sona.actions.OpenServersAction"
                textKey="serversAction"
                descriptionKey="serversActionDescription"
                icon="AllIcons.Webreferences.Server"/>


        <action id="OpenSonaToolWindowAction"
                class="io.qent.sona.actions.OpenSonaAction"
                textKey="openSonaAction"
                descriptionKey="openSonaActionDescription">
            <keyboard-shortcut keymap="$default" first-keystroke="meta control S"/>
        </action>
    </actions>

    <extensions defaultExtensionNs="com.intellij">
        <toolWindow
                id="Sona"
                factoryClass="io.qent.sona.PluginToolWindowFactory"
                icon="/icons/harp.svg"
                secondary="false"
                anchor="right"/>

        <applicationService serviceImplementation="io.qent.sona.repositories.PluginSettingsRepository"/>
        <applicationService serviceImplementation="io.qent.sona.repositories.PluginChatRepository"/>
        <applicationService serviceImplementation="io.qent.sona.repositories.PluginRolesRepository"/>
        <applicationService serviceImplementation="io.qent.sona.repositories.PluginPresetsRepository"/>
        <applicationService serviceImplementation="io.qent.sona.repositories.PluginUserPromptRepository"/>
        <applicationService serviceImplementation="io.qent.sona.services.ThemeService"/>
        <projectService serviceImplementation="io.qent.sona.repositories.PluginMcpServersRepository"/>

        <applicationConfigurable
                id="SonaChatSettings"
                displayName="Sona"
                instance="io.qent.sona.settings.PluginSettingsConfigurable"
                parentId="tools"/>
    </extensions>
</idea-plugin>
